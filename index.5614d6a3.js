var t,e={};const s=new((t=class{constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.initialState=t.map(t=>[...t]),this.state=this.initialState.map(t=>[...t]),this.score=0,this.status="idle"}moveLeft(){if("playing"!==this.status)return;let t=!1;for(let e=0;e<4;e++){let s=this.merge(this.state[e]);s.toString()!==this.state[e].toString()&&(t=!0),this.state[e]=s}t&&this.spawn(),this.checkLose(),this.checkWin()}moveRight(){this.state=this.state.map(t=>t.reverse()),this.moveLeft(),this.state=this.state.map(t=>t.reverse())}moveUp(){this.transpose(),this.moveLeft(),this.transpose()}moveDown(){this.transpose(),this.moveRight(),this.transpose()}getScore(){return this.score}getState(){return this.state.map(t=>[...t])}getStatus(){return this.status}start(){this.status="playing",this.spawn(),this.spawn(),this.checkWin(),this.checkLose()}restart(){this.state=this.initialState.map(t=>[...t]),this.score=0,this.status="idle"}spawn(){let t=[];for(let e=0;e<4;e++)for(let s=0;s<4;s++)0===this.state[e][s]&&t.push({row:e,column:s});if(t.length>0){let{row:e,column:s}=t[Math.floor(Math.random()*t.length)];this.state[e][s]=.9>Math.random()?2:4}}transpose(){let t=this.initialState.map(t=>[...t]);for(let e=0;e<4;e++)for(let s=0;s<4;s++)t[s][e]=this.state[e][s];this.state=t}merge(t){let e=t.filter(t=>0!==t);for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&(e[t]*=2,this.score+=e[t],e[t+1]=0);for(e=e.filter(t=>0!==t);4!==e.length;)e.push(0);return e}checkWin(){for(let t=0;t<4;t++)for(let e=0;e<4;e++)2048===this.state[t][e]&&(this.status="win")}checkLose(){for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(0===this.state[t][e])return;for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(t<3&&this.state[t][e]===this.state[t+1][e]||e<3&&this.state[t][e]===this.state[t][e+1])return;this.status="lose"}}).__esModule?t.default:t),a=document.querySelectorAll(".field-cell"),i=document.querySelector(".button.start");function r(){let t=0,e=s.getState();for(let s=0;s<4;s++)for(let i=0;i<4;i++){let r=a[t];r.className="field-cell",e[s][i]?(r.textContent=e[s][i],r.classList.add(`field-cell--${e[s][i]}`)):r.textContent="",t++}document.querySelector(".game-score").textContent=s.getScore();let i=s.getStatus();"win"===i?document.querySelector(".message-win").classList.remove("hidden"):"lose"===i&&document.querySelector(".message-lose").classList.remove("hidden")}document.addEventListener("keydown",t=>{if("playing"===s.getStatus()){switch(t.key){case"ArrowLeft":s.moveLeft();break;case"ArrowRight":s.moveRight();break;case"ArrowUp":s.moveUp();break;case"ArrowDown":s.moveDown()}r()}}),i.addEventListener("click",()=>{"button restart"===i.className&&s.restart(),s.start(),r(),document.querySelector(".message-win").classList.add("hidden"),document.querySelector(".message-lose").classList.add("hidden"),document.querySelector(".message-start").classList.add("hidden"),i.textContent="Restart",i.className="button restart"});
//# sourceMappingURL=index.5614d6a3.js.map
